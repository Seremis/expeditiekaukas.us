
/**
 * Called when the google maps api code has loaded (happens async). This initializes a map with the muted blue style.
 */
function initMap() {
    var styledMapType = new google.maps.StyledMapType([{"featureType":"all","stylers":[{"saturation":0},{"hue":"#e7ecf0"}]},{"featureType":"road","stylers":[{"saturation":-70}]},{"featureType":"transit","stylers":[{"visibility":"off"}]},{"featureType":"poi","stylers":[{"visibility":"off"}]},{"featureType":"water","stylers":[{"visibility":"simplified"},{"saturation":-60}]}], {name: "{{ mapslayoutName}}"});

    var mapProp= {
        center:new google.maps.LatLng(39.6006623,45.7051961),
        zoom:7,
        mapTypeControlOptions: {
            mapTypeIds: ['roadmap', 'satellite', 'hybrid', 'terrain',
                'styled_map']
        }
    };

    var map=new google.maps.Map(document.getElementById("map"),mapProp);

    map.mapTypes.set('styled_map', styledMapType);
    map.setMapTypeId('styled_map');

    loadRoutes(map);
}

function loadRoutes(map) {
    console.log("Loading people...")
    getPeople(
        successCallback = function(data) {
            console.log("Loading people succeeded!")

            $.each( data, function( key, val ) {
                console.log(key + " " + val);
            });
        },
        errorCallback = function (data) {
            alert({{ errorLoadingTryAgain }})
        }
    );
}


function getPeople(successCallback, errorCallback) {
    $.ajax({
        url: "https://expeditiekaukas.us/api/person",
        success: successCallback,
        error: errorCallback
    });
}

function getRoute(personName, successCallback, errorCallback) {
    $.ajax({
        url: "https://expeditiekaukas.us/api/route/" + personName,
        dataType: "json",
        success: successCallback,
        error: errorCallback
    });
}